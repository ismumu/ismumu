<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>ismumu's home - ismumu' home</title>
	<link rel="shortcut icon" href="/favicon.ico">
	<script src="/js/jquery/jquery.min.js"></script>
	<script src="/js/popper/popper.min.js"></script>
	<script src="/js/bootstrap/bootstrap.min.js"></script>
	<script src="/js/jquery/jquery.pin.js"></script>
	<script src="/js/gitment/gitment.js"></script>
	<script src="/js/blog/canvas.code.js"></script>

	<link rel="stylesheet" href="/css/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="/css/fonts/font-awesome.min.css">
	<link rel="stylesheet" href="/css/gitment/gitment.css">
	<link rel="stylesheet" href="/css/common/common.css">
	<link rel="stylesheet" href="/css/highlight/highlight.css">
	<link rel="stylesheet" href="/css/tag/tag.css">


</head>

<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
	<a class="navbar-brand" href="/2018/04/29/node-multer.html">ismumu' home</a> | 
	<div class="collapse navbar-collapse">
		<ul class="navbar-nav">
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=Javascript">Javascript</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=GitHub">GitHub</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=Regex">Regex</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=Nginx">Nginx</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=Linux">Linux</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=Svn">Svn</a>
				</li>
			 
				<li class="nav-item">
					<a class="nav-link" href="/tag.html?tag=MySQL">MySQL</a>
				</li>
			
		</ul>
	</div>
</nav>
<canvas class="blog-canvas" id="J-blog-canvas"></canvas>
<div class="container-fluid">
	<div class="row">
		<div class="col-sm-3 sidebar">
			<div class="tag-list">
				<ul></ul>
			</div>
		</div>
		<div class="col-sm-9">
			<div class="blog-content">
				<h1 class="J-tag-h1"></h1>
				<div class="J-tag-content"></div>
				<div id="comments"></div>
				<div class="aa"></div>
			</div>
		</div>
	</div>
</div>
<script>

var tagData = {}


	
	tagData.Javascript = [];
	
	tagData.Javascript = [];
	
	tagData.Javascript = [];
	

	
	tagData.GitHub = [];
	

	
	tagData.Regex = [];
	

	
	tagData.Nginx = [];
	
	tagData.Nginx = [];
	

	
	tagData.Linux = [];
	

	
	tagData.Svn = [];
	

	
	tagData.MySQL = [];
	



	
	tagData.Javascript.push({
		title: `node + express + multer上传图片`,
		date: 29/04/2018,
		content: `<h2 id="一服务端配置">一、服务端配置</h2>

<p>在express生成器生成的项目里找到根目录下的app.js，并进行以下修改</p>

<p>1.引入安装依赖</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">multer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'multer'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">upload</span> <span class="o">=</span> <span class="nx">multer</span><span class="p">({</span> <span class="na">dest</span><span class="p">:</span> <span class="s1">'uploads/'</span> <span class="p">})</span>
</code></pre></div></div>

<p>2.添加上传图片的路由</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 多个文件上传</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/upload-multiple'</span><span class="p">,</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="s1">'myfile'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// 上传的多个文件的信息，数组类型</span>
	<span class="kd">let</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>

	<span class="nx">files</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="kd">let</span> <span class="nx">suffix</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">originalname</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
		<span class="nx">fs</span><span class="p">.</span><span class="nx">renameSync</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">path</span> <span class="o">+</span> <span class="s1">'.'</span> <span class="o">+</span> <span class="nx">suffix</span><span class="p">);</span>
	<span class="p">})</span>

	<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"done"</span><span class="p">);</span>
<span class="p">})</span>

<span class="c1">// 单个文件上传</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/upload'</span><span class="p">,</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">single</span><span class="p">(</span><span class="s1">'logo'</span><span class="p">),</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// 上传的文件信息</span>
	<span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">file</span><span class="p">;</span>

	<span class="c1">// 图片后缀</span>
	<span class="kd">let</span> <span class="nx">suffix</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">originalname</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>

	<span class="nx">fs</span><span class="p">.</span><span class="nx">renameSync</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nx">file</span><span class="p">.</span><span class="nx">path</span> <span class="o">+</span> <span class="s1">'.'</span> <span class="o">+</span> <span class="nx">suffix</span><span class="p">);</span>

	<span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'done'</span><span class="p">);</span>

<span class="p">});</span>
</code></pre></div></div>

<h2 id="二客户端配置">二、客户端配置</h2>

<p>创建一个html并且写入：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"/upload"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"logo"</span><span class="nt">&gt;&lt;/input&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"提交"</span><span class="nt">&gt;&lt;/input&gt;</span>
<span class="nt">&lt;/form&gt;</span>


<span class="nt">&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;</span>

<span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"/upload-multiple"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"myfile"</span><span class="nt">&gt;&lt;/input&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"myfile"</span><span class="nt">&gt;&lt;/input&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"提交"</span><span class="nt">&gt;&lt;/input&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<h2 id="123123">123123</h2>

`,
		url: `/2018/04/29/node-multer.html`,
	})
	
	tagData.Javascript.push({
		title: `React-echarts-graph`,
		date: 19/04/2018,
		content: `<h3 id="效果图">效果图</h3>

<p>可点击查看大图</p>

<p><a href="/images/blog/1.png" target="_blank"><img style="width: 100%;" src="/images/blog/1.png" /></a></p>

<p>1.安装依赖包</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="nx">echarts</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="nx">react</span>
<span class="nx">npm</span> <span class="nx">install</span> <span class="o">--</span><span class="nx">save</span> <span class="nx">echarts</span>
</code></pre></div></div>

<p>2.mock接口返回数据</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> 
<span class="p">{</span>
	<span class="s2">"code"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
	<span class="s2">"message"</span><span class="p">:</span> <span class="s2">"操作成功！"</span><span class="p">,</span>
	<span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span>
		<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
		<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
		<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"下单"</span><span class="p">,</span>
		<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
		<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"货主下单"</span><span class="p">,</span>
		<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:40:59"</span><span class="p">,</span>
		<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
		<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
			<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
			<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
			<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"分配"</span><span class="p">,</span>
			<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
			<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"分配Test测试承运商"</span><span class="p">,</span>
			<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:41:18"</span><span class="p">,</span>
			<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
			<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
				<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
				<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"接单"</span><span class="p">,</span>
				<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
				<span class="s2">"remark"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
				<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:42:07"</span><span class="p">,</span>
				<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
				<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
					<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
					<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
					<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"完成(承运商)"</span><span class="p">,</span>
					<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
					<span class="s2">"remark"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
					<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:52:04"</span><span class="p">,</span>
					<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="p">[{</span>
						<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
						<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
						<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"调度"</span><span class="p">,</span>
						<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
						<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"配载"</span><span class="p">,</span>
						<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:43:09"</span><span class="p">,</span>
						<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
							<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
							<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
							<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"发车"</span><span class="p">,</span>
							<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
							<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"调度发车，车牌号：浙B11111"</span><span class="p">,</span>
							<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:45:43"</span><span class="p">,</span>
							<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
								<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
								<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
								<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"发运"</span><span class="p">,</span>
								<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
								<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"发运"</span><span class="p">,</span>
								<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:46:21"</span><span class="p">,</span>
								<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
								<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
									<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
									<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
									<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"签收"</span><span class="p">,</span>
									<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
									<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"卸货"</span><span class="p">,</span>
									<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:48:28"</span><span class="p">,</span>
									<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
									<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
										<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
										<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"9876"</span><span class="p">,</span>
										<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"回单(承运商)"</span><span class="p">,</span>
										<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
										<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"回单"</span><span class="p">,</span>
										<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:52:04"</span><span class="p">,</span>
										<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
										<span class="s2">"children"</span><span class="p">:</span> <span class="kc">null</span>
									<span class="p">}</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">},</span> <span class="p">{</span>
						<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
						<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"5644"</span><span class="p">,</span>
						<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"调度"</span><span class="p">,</span>
						<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
						<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"配载"</span><span class="p">,</span>
						<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:44:58"</span><span class="p">,</span>
						<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
							<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
							<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"5644"</span><span class="p">,</span>
							<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"发车"</span><span class="p">,</span>
							<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
							<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"调度发车，车牌号：浙B11111"</span><span class="p">,</span>
							<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:45:29"</span><span class="p">,</span>
							<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
								<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
								<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"5644"</span><span class="p">,</span>
								<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"发运"</span><span class="p">,</span>
								<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
								<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"发运"</span><span class="p">,</span>
								<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:46:31"</span><span class="p">,</span>
								<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
								<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
									<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
									<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"5644"</span><span class="p">,</span>
									<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"签收"</span><span class="p">,</span>
									<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
									<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"卸货"</span><span class="p">,</span>
									<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:48:42"</span><span class="p">,</span>
									<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
									<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
										<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span>
										<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="s2">"5644"</span><span class="p">,</span>
										<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"回单(承运商)"</span><span class="p">,</span>
										<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="s2">"浙B11111"</span><span class="p">,</span>
										<span class="s2">"remark"</span><span class="p">:</span> <span class="s2">"回单"</span><span class="p">,</span>
										<span class="s2">"createDate"</span><span class="p">:</span> <span class="s2">"2018-04-18 17:51:31"</span><span class="p">,</span>
										<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
										<span class="s2">"children"</span><span class="p">:</span> <span class="kc">null</span>
									<span class="p">}</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">}],</span>
					<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
						<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"回单(货主)"</span><span class="p">,</span>
						<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"remark"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"createDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
						<span class="s2">"children"</span><span class="p">:</span> <span class="p">{</span>
							<span class="s2">"omsRequestOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"shippingOrderNo"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"logisticsStatus"</span><span class="p">:</span> <span class="s2">"完成(货主)"</span><span class="p">,</span>
							<span class="s2">"plateNumber"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"remark"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"createDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"operateRecordList"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
							<span class="s2">"children"</span><span class="p">:</span> <span class="kc">null</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<p>3.原始组件数据结构</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 时间轴数据</span>
<span class="nx">TimeLineOptionData</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// tooltip: {</span>
        <span class="c1">// formatter: function (params) {</span>
        <span class="c1">//     if ( params.data.remark ) {</span>
        <span class="c1">//         return '备注：'+ params.data.remark;</span>
        <span class="c1">//     } else {</span>
        <span class="c1">//         return '';</span>
        <span class="c1">//     }</span>
        <span class="c1">// },</span>
    <span class="c1">// },</span>
    <span class="nl">textStyle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">color</span><span class="p">:</span> <span class="s1">'#000'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1">// animationDurationUpdate: 1500,</span>
    <span class="c1">// animationEasingUpdate: 'quinticInOut',</span>
    <span class="nx">series</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'graph'</span><span class="p">,</span>
            <span class="na">layout</span><span class="p">:</span> <span class="s1">'none'</span><span class="p">,</span>
            <span class="na">color</span><span class="p">:</span> <span class="p">[</span><span class="s1">'#07b483'</span><span class="p">],</span>
            <span class="na">symbolSize</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="c1">// 图标大小</span>
            <span class="na">roam</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">label</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">normal</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">show</span><span class="p">:</span> <span class="kc">true</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="na">edgeSymbol</span><span class="p">:</span> <span class="p">[</span><span class="s1">'circle'</span><span class="p">,</span> <span class="s1">'arrow'</span><span class="p">],</span>
            <span class="na">edgeSymbolSize</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="na">edgeLabel</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">normal</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">textStyle</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">fontSize</span><span class="p">:</span> <span class="mi">20</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="na">data</span><span class="p">:</span> <span class="p">[],</span>
            <span class="na">links</span><span class="p">:</span> <span class="p">[],</span>
            <span class="na">lineStyle</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">normal</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">opacity</span><span class="p">:</span> <span class="p">.</span><span class="mi">9</span><span class="p">,</span>
                    <span class="na">width</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="na">curveness</span><span class="p">:</span> <span class="mi">0</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">},</span>
</code></pre></div></div>

<p>4.遍历组装数据格式</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">_data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>



<span class="kd">let</span> <span class="nx">_TimeLineData</span> <span class="o">=</span> <span class="p">[];</span>

<span class="cm">/**
    *
    * @param {当前数据} nowData
    * @param {索引值} index
    */</span>
<span class="kd">let</span> <span class="nx">deepTree</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">nowData</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">let</span> <span class="nx">_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">200</span><span class="p">];</span>

    <span class="kd">let</span> <span class="nx">_obj</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">logisticsStatus</span><span class="p">,</span>
        <span class="na">legendHoverLink</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">x</span><span class="p">:</span> <span class="nx">_x</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span>
        <span class="na">y</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
        <span class="na">remark</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">remark</span><span class="p">,</span>
        <span class="na">createDate</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span> <span class="p">?</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">label</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">show</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">position</span><span class="p">:</span> <span class="s1">'bottom'</span><span class="p">,</span>
            <span class="na">fontSize</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
            <span class="na">distance</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="na">formatter</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span><span class="s1">'</span><span class="err">\</span><span class="s1">n</span><span class="err">\</span><span class="s1">n'</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">createDate</span><span class="p">;</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span> <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 没有时间显示灰色圆圈</span>
        <span class="nx">_obj</span><span class="p">.</span><span class="nx">itemStyle</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">color</span><span class="p">:</span> <span class="s1">'#CCC'</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">_TimeLineData</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">_obj</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">index</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">deepTree</span><span class="p">(</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">deepTree</span><span class="p">(</span><span class="nx">_data</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">_TimeLineDataLinks</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">_TimeLineData</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">_TimeLineData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="nx">_TimeLineDataLinks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
            <span class="na">source</span><span class="p">:</span> <span class="nx">d</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
            <span class="na">target</span><span class="p">:</span> <span class="nx">_TimeLineData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">})</span>


<span class="c1">// 遍历分叉数据</span>
<span class="kd">var</span> <span class="nx">operateRecordList</span> <span class="o">=</span> <span class="nx">_data</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">operateRecordList</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">operateRecordList</span> <span class="o">&amp;&amp;</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">let</span> <span class="nx">_y</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="c1">// 分叉数据最多支持7条</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">120</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">130</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">140</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">160</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">6</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">170</span><span class="p">]</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nx">operateRecordList</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">_array</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kd">let</span> <span class="nx">_deepTree</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">nowData</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>



            <span class="kd">let</span> <span class="nx">_obj</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">name</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">logisticsStatus</span> <span class="o">+</span> <span class="nx">i</span><span class="p">,</span>
                <span class="na">_name</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">logisticsStatus</span><span class="p">,</span>
                <span class="na">x</span><span class="p">:</span> <span class="nx">index</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">60</span><span class="p">,</span>
                <span class="na">y</span><span class="p">:</span> <span class="nx">_y</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
                <span class="na">remark</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">remark</span><span class="p">,</span>
                <span class="na">createDate</span><span class="p">:</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span> <span class="p">?</span> <span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
                <span class="na">label</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">show</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">position</span><span class="p">:</span> <span class="s1">'bottom'</span><span class="p">,</span>
                    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                    <span class="na">distance</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="na">formatter</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">createDate</span> <span class="p">)</span> <span class="p">{</span>
                            <span class="k">return</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_name</span> <span class="o">+</span><span class="s1">'</span><span class="err">\</span><span class="s1">n</span><span class="err">\</span><span class="s1">n'</span> <span class="o">+</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">createDate</span><span class="p">;</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="k">return</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_name</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">createDate</span> <span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 没有时间显示灰色圆圈</span>
                <span class="nx">_obj</span><span class="p">.</span><span class="nx">itemStyle</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="na">color</span><span class="p">:</span> <span class="s1">'#CCC'</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">_array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">_obj</span><span class="p">);</span>


            <span class="k">if</span><span class="p">(</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">index</span><span class="o">++</span><span class="p">;</span>
                <span class="nx">_deepTree</span><span class="p">(</span><span class="nx">nowData</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">_deepTree</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="nx">_TimeLineData</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">_array</span><span class="p">);</span>

        <span class="c1">// 从第3个分出去的分支线</span>
        <span class="kd">let</span> <span class="nx">_links</span> <span class="o">=</span> <span class="p">[{</span>
            <span class="na">source</span><span class="p">:</span> <span class="nx">_TimeLineData</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
            <span class="na">target</span><span class="p">:</span> <span class="nx">_array</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
        <span class="p">}];</span>
            <span class="nx">_array</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">_array</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">_links</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
                    <span class="na">source</span><span class="p">:</span> <span class="nx">d</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
                    <span class="na">target</span><span class="p">:</span> <span class="nx">_array</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">})</span>

        <span class="c1">// 分支线最后一个回归主线到第4个</span>
        <span class="nx">_links</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
            <span class="na">source</span><span class="p">:</span> <span class="nx">_array</span><span class="p">[</span><span class="nx">_array</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
            <span class="na">target</span><span class="p">:</span> <span class="nx">_TimeLineData</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span>
        <span class="p">})</span>
        <span class="nx">_TimeLineDataLinks</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="nx">_links</span><span class="p">);</span>

    <span class="p">})</span>
<span class="p">}</span>



<span class="nx">TimeLineOptionData</span><span class="p">.</span><span class="nx">series</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">_TimeLineData</span><span class="p">;</span>
<span class="nx">TimeLineOptionData</span><span class="p">.</span><span class="nx">series</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">links</span> <span class="o">=</span> <span class="nx">_TimeLineDataLinks</span><span class="p">;</span>
</code></pre></div></div>

<p>5.组件调用</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">ReactEcharts</span>
    <span class="nx">option</span><span class="o">=</span><span class="p">{</span><span class="nx">TimeLineOptionData</span><span class="p">}</span>
    <span class="nx">notMerge</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
    <span class="nx">lazyUpdate</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
    <span class="nx">theme</span><span class="o">=</span><span class="p">{</span><span class="s2">"light"</span><span class="p">}</span>
<span class="sr">/</span><span class="err">&gt;
</span></code></pre></div></div>

<hr />

`,
		url: `/2018/04/19/echarts-graph.html`,
	})
	
	tagData.Javascript.push({
		title: `new Date 不同时区的转换`,
		date: 06/06/2016,
		content: `<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">calcTime</span><span class="p">(</span><span class="nx">city</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span> 
  <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> 
  <span class="kd">var</span> <span class="nx">utc</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60000</span><span class="p">);</span> 
  <span class="kd">var</span> <span class="nx">nd</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">utc</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3600000</span> <span class="o">*</span> <span class="nx">offset</span><span class="p">));</span> 
  <span class="k">return</span> <span class="s2">"The local time in "</span> <span class="o">+</span> <span class="nx">city</span> <span class="o">+</span> <span class="s2">" is "</span> <span class="o">+</span> <span class="nx">nd</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">();</span> 
<span class="p">}</span>

<span class="nx">alert</span><span class="p">(</span><span class="nx">calcTime</span><span class="p">(</span><span class="s1">'Singapore'</span><span class="p">,</span> <span class="s1">'+8'</span><span class="p">));</span><span class="c1">//强制转换成中国时间</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">calcTime</span><span class="p">(</span><span class="s1">'Singapore'</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTimezoneOffset</span><span class="p">()</span><span class="o">/</span><span class="mi">60</span><span class="p">));</span><span class="c1">//各地当地时间</span>

</code></pre></div></div>
`,
		url: `/2016/06/06/different-time-zones.html`,
	})
	

	
	tagData.GitHub.push({
		title: `创建github page`,
		date: 05/06/2017,
		content: `<h2 id="1选择自己的一个github项目">1.选择自己的一个github项目</h2>

<p>项目中包含已经打包好的build或者dist文件目录（纯静态html网站，github暂不支持类似React,vue的单页面）</p>

<h2 id="2安装gh-pages包">2.安装gh-pages包</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">gh</span><span class="o">-</span><span class="nx">pages</span> <span class="o">--</span><span class="nx">save</span>
</code></pre></div></div>

<h2 id="3在packagejson-文件中添加">3.在package.json 文件中添加</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"predeploy"</span><span class="p">:</span> <span class="s2">"npm run build"</span><span class="p">,</span> <span class="c1">// 打包命令</span>
<span class="s2">"deploy"</span><span class="p">:</span> <span class="s2">"gh-pages -d dist"</span> <span class="c1">// 创建一个分支名字叫gh-pages，内容是根目录下的dist文件夹内容</span>
</code></pre></div></div>

<h2 id="4执行">4.执行</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">run</span> <span class="nx">deploy</span>
</code></pre></div></div>

<p>执行 deploy 的时候会先执行 predeploy 命令</p>

<h2 id="5访问页面">5.访问页面</h2>

<p>在github项目中找到Settings选项卡，拉到下面会看到GitHub Pages，域名已经帮你自动生成好了，可以直接访问。</p>
`,
		url: `/2017/06/05/create-github-pages.html`,
	})
	

	
	tagData.Regex.push({
		title: `常用正则总结`,
		date: 08/07/2017,
		content: `<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">// 匹配允许0的正整数，但是不允许01， 001格式</span>
<span class="o">/^</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="err">\</span><span class="nx">d</span><span class="o">*|</span><span class="p">[</span><span class="mi">0</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">})</span><span class="nx">$</span><span class="o">/</span>

<span class="c1">// 邮箱</span>
<span class="sr">/^</span><span class="se">[</span><span class="sr">a-zA-Z0-9_-</span><span class="se">]</span><span class="sr">+@</span><span class="se">[</span><span class="sr">a-zA-Z0-9_-</span><span class="se">]</span><span class="sr">+</span><span class="se">(\.[</span><span class="sr">a-zA-Z0-9_-</span><span class="se">]</span><span class="sr">+</span><span class="se">)</span><span class="sr">+$/</span>
<span class="o">/^</span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="nx">Za</span><span class="o">-</span><span class="nx">z</span><span class="err">\</span><span class="nx">d</span><span class="p">]</span><span class="o">+</span><span class="p">([</span><span class="o">-</span><span class="nx">_</span><span class="p">.][</span><span class="nx">A</span><span class="o">-</span><span class="nx">Za</span><span class="o">-</span><span class="nx">z</span><span class="err">\</span><span class="nx">d</span><span class="p">]</span><span class="o">+</span><span class="p">)</span><span class="o">*</span><span class="p">@([</span><span class="nx">A</span><span class="o">-</span><span class="nx">Za</span><span class="o">-</span><span class="nx">z</span><span class="err">\</span><span class="nx">d</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="p">.])</span><span class="o">+</span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="nx">Za</span><span class="o">-</span><span class="nx">z</span><span class="err">\</span><span class="nx">d</span><span class="p">]{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">}</span><span class="nx">$</span><span class="o">/</span>

<span class="c1">// 座机号码</span>
<span class="sr">/^</span><span class="se">(([</span><span class="sr">0</span><span class="se">\+]\d{2,3}</span><span class="sr">-</span><span class="se">)?(</span><span class="sr">0</span><span class="se">\d{2,3})</span><span class="sr">-</span><span class="se">)(\d{7,8})(</span><span class="sr">-</span><span class="se">(\d{3,}))?</span><span class="sr">$/</span>

<span class="c1">// 手机号码</span>
<span class="o">/^</span><span class="mi">13</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">9</span><span class="p">}</span><span class="nx">$</span><span class="o">|</span><span class="mi">14</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">9</span><span class="p">}</span><span class="o">|</span><span class="mi">15</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">9</span><span class="p">}</span><span class="nx">$</span><span class="o">|</span><span class="mi">17</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">9</span><span class="p">}</span><span class="nx">$</span><span class="o">|</span><span class="mi">18</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">9</span><span class="p">}</span><span class="nx">$</span><span class="o">/</span>

<span class="c1">// 图片格式</span>
<span class="sr">/</span><span class="se">\.(</span><span class="sr">gif|jpg|jpeg|png|GIF|JPG|PNG</span><span class="se">)</span><span class="sr">$/</span>

<span class="c1">// 身份证号码验证</span>
<span class="o">/^</span><span class="p">(</span><span class="err">\</span><span class="nx">d</span><span class="p">{</span><span class="mi">15</span><span class="p">}</span><span class="nx">$</span><span class="o">|^</span><span class="err">\</span><span class="nx">d</span><span class="p">{</span><span class="mi">18</span><span class="p">}</span><span class="nx">$</span><span class="o">|^</span><span class="err">\</span><span class="nx">d</span><span class="p">{</span><span class="mi">17</span><span class="p">}(</span><span class="err">\</span><span class="nx">d</span><span class="o">|</span><span class="nx">X</span><span class="o">|</span><span class="nx">x</span><span class="p">))</span><span class="nx">$</span><span class="o">/</span>

<span class="c1">// 验证金钱格式，x or x.x or x.xx ,x为数字，不允许0开头</span>
<span class="sr">/^</span><span class="se">(?=[\d</span><span class="sr">.</span><span class="se">]{1,15})([</span><span class="sr">1-9</span><span class="se">]\d{1,14}</span><span class="sr">|</span><span class="se">\d)([</span><span class="sr">.</span><span class="se">][</span><span class="sr">0-9</span><span class="se">]{0,2})?</span><span class="sr">$/</span>

<span class="c1">// 1-15位的纯数字</span>
<span class="o">/^</span><span class="err">\</span><span class="nx">d</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">}</span><span class="nx">$</span><span class="o">/</span><span class="p">,</span>

</code></pre></div></div>
`,
		url: `/2017/07/08/regex.html`,
	})
	

	
	tagData.Nginx.push({
		title: `在Nginx下配置使用单页面spa`,
		date: 09/08/2017,
		content: `<p>配置如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">server</span> <span class="p">{</span>
	<span class="nx">listen</span>  <span class="mi">80</span><span class="p">;</span>
	<span class="nx">server_name</span> <span class="nx">ismumu</span><span class="p">.</span><span class="nx">com</span><span class="p">;</span>
	<span class="nx">location</span> <span class="o">/</span> <span class="p">{</span>
		<span class="nx">try_files</span> <span class="nx">$uri</span> <span class="nx">$uri</span><span class="o">/</span> <span class="sr">/index.html</span><span class="err">;
</span>		<span class="nx">root</span> <span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">dva</span><span class="o">-</span><span class="nx">demo</span><span class="o">/</span><span class="nx">dist</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
`,
		url: `/2017/08/09/nginx-spa.html`,
	})
	
	tagData.Nginx.push({
		title: `Nginx开启gzip`,
		date: 08/08/2017,
		content: `<p>配置如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gzip</span>  <span class="nx">on</span><span class="p">;</span>
<span class="nx">gzip_min_length</span> <span class="mi">1</span><span class="nx">k</span><span class="p">;</span>
<span class="nx">gzip_buffers</span> <span class="mi">4</span> <span class="mi">16</span><span class="nx">k</span><span class="p">;</span>
<span class="nx">gzip_http_version</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="nx">gzip_comp_level</span> <span class="mi">5</span><span class="p">;</span>
<span class="nx">gzip_types</span> <span class="nx">text</span><span class="o">/</span><span class="nx">plain</span> <span class="nx">application</span><span class="o">/</span><span class="nx">javascript</span> <span class="nx">application</span><span class="o">/</span><span class="nx">x</span><span class="o">-</span><span class="nx">javascript</span> <span class="nx">text</span><span class="o">/</span><span class="nx">javascript</span> <span class="nx">text</span><span class="o">/</span><span class="nx">xml</span> <span class="nx">text</span><span class="o">/</span><span class="nx">css</span><span class="p">;</span>
<span class="nx">gzip_disable</span> <span class="s2">"MSIE [1-6]</span><span class="err">\</span><span class="s2">."</span><span class="p">;</span>
<span class="nx">gzip_vary</span> <span class="nx">on</span><span class="p">;</span>
</code></pre></div></div>
`,
		url: `/2017/08/08/gzip.html`,
	})
	

	
	tagData.Linux.push({
		title: `linux常见问题汇总`,
		date: 21/03/2018,
		content: `<h3 id="1-centos安装node">1. centos安装node</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span> <span class="nx">curl</span> <span class="o">--</span><span class="nx">silent</span> <span class="o">--</span><span class="nx">location</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//rpm.nodesource.com/setup_8.x | bash -</span>
<span class="mi">2</span><span class="p">.</span> <span class="nx">yum</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">y</span> <span class="nx">nodejs</span>
</code></pre></div></div>

<hr />

<h3 id="2-centos7-开放端口">2. Centos7 开放端口</h3>

<p>Centos升级到7之后，发现无法使用iptables控制Linuxs的端口，之后发现Centos 7使用firewalld代替了原来的iptables。下面记录如何使用firewalld开放Linux端口：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 开启端口</span>
<span class="nx">firewall</span><span class="o">-</span><span class="nx">cmd</span> <span class="o">--</span><span class="nx">zone</span><span class="o">=</span><span class="kr">public</span> <span class="o">--</span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="o">=</span><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span> <span class="o">--</span><span class="nx">permanent</span>

<span class="c1">// 命令含义：</span>
<span class="o">--</span><span class="nx">zone</span> <span class="c1">// 作用域</span>
<span class="o">--</span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="o">=</span><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span> <span class="c1">// 添加端口，格式为：端口/通讯协议</span>
<span class="o">--</span><span class="nx">permanent</span> <span class="c1">// 永久生效，没有此参数重启后失效</span>

<span class="c1">// 然后重启防火墙生效</span>
<span class="nx">firewall</span><span class="o">-</span><span class="nx">cmd</span> <span class="o">--</span><span class="nx">reload</span> 

</code></pre></div></div>

`,
		url: `/2018/03/21/linux.html`,
	})
	

	
	tagData.Svn.push({
		title: `svn常见问题汇总`,
		date: 21/03/2018,
		content: `<h2 id="1-子目录添加了很多文件导致不能add">1. 子目录添加了很多文件导致不能add</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">svn</span><span class="p">:</span> <span class="nx">warning</span><span class="p">:</span> <span class="nx">W150002</span><span class="p">:</span> <span class="s1">'/Users/ismumu/svn/xxxx/xxxx'</span> <span class="nx">is</span> <span class="nx">already</span> <span class="nx">under</span> <span class="nx">version</span> <span class="nx">control</span>
<span class="nx">svn</span><span class="p">:</span> <span class="nx">E200009</span><span class="p">:</span> <span class="nx">Could</span> <span class="nx">not</span> <span class="nx">add</span> <span class="nx">all</span> <span class="nx">targets</span> <span class="nx">because</span> <span class="nx">some</span> <span class="nx">targets</span> <span class="nx">are</span> <span class="nx">already</span> <span class="nx">versioned</span>
<span class="nx">svn</span><span class="p">:</span> <span class="nx">E200009</span><span class="p">:</span> <span class="nx">Illegal</span> <span class="nx">target</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">requested</span> <span class="nx">operation</span>

<span class="c1">// 解决办法，这样就可以把这个目录的最新状态提交上去了。</span>
<span class="nx">svn</span> <span class="nx">add</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">ismumu</span><span class="o">/</span><span class="nx">svn</span><span class="o">/</span><span class="nx">xxxx</span><span class="o">/</span><span class="nx">xxxxx</span><span class="p">(</span><span class="err">目录名</span><span class="p">)</span> <span class="o">--</span><span class="nx">force</span>
</code></pre></div></div>

<hr />

`,
		url: `/2018/03/21/svn.html`,
	})
	

	
	tagData.MySQL.push({
		title: `mysql查看当前端口号`,
		date: 03/04/2018,
		content: `<h2 id="1-子目录添加了很多文件导致不能add">1. 子目录添加了很多文件导致不能add</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">mysql</span><span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">variables</span> <span class="nx">like</span> <span class="s1">'port'</span><span class="p">;</span>
<span class="o">+---------------+-------+</span>
<span class="o">|</span> <span class="nx">Variable_name</span> <span class="o">|</span> <span class="nx">Value</span> <span class="o">|</span>
<span class="o">+---------------+-------+</span>
<span class="o">|</span> <span class="nx">port</span>          <span class="o">|</span> <span class="mi">3306</span>  <span class="o">|</span>
<span class="o">+---------------+-------+</span>
<span class="mi">1</span> <span class="nx">row</span> <span class="k">in</span> <span class="kd">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="nx">sec</span><span class="p">)</span>
</code></pre></div></div>

<hr />

`,
		url: `/2018/04/03/mysql-check-port.html`,
	})
	


</script>
<script src="/js/tag/tag.js"></script>

</body>
</html>